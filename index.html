<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MİNCRAT - Tarayıcıda 3D Minecraft Tarzı Oyun</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #202020;
      font-family: monospace;
      color: #fff;
    }
    #menu {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: radial-gradient(circle, #2a2a2a 0%, #000 100%);
      z-index: 10;
    }
    #menu h1 {
      font-size: 4em;
      color: #6aff6a;
      text-shadow: 0 0 20px #00ff00;
      margin-bottom: 40px;
    }
    #menu button {
      background-color: #333;
      border: 2px solid #6aff6a;
      color: #6aff6a;
      font-size: 1.5em;
      padding: 10px 20px;
      margin: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    #menu button:hover {
      background-color: #6aff6a;
      color: #111;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <div id="menu">
    <h1>MİNCRAT</h1>
    <button id="creativeBtn">Yaratıcılık Modu</button>
    <button id="survivalBtn">Hayatta Kalma Modu</button>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>

  <script>
  let scene, camera, renderer;
  let player = { velocity: new THREE.Vector3(), direction: new THREE.Vector3() };
  let keys = {};
  let canJump = false;
  let controlsEnabled = false;
  let mode = "creative";

  const BLOCK_SIZE = 2;
  const WORLD_SIZE = 20;

  const clock = new THREE.Clock();

  document.getElementById("creativeBtn").onclick = () => startGame("creative");
  document.getElementById("survivalBtn").onclick = () => startGame("survival");

  function startGame(selectedMode) {
    mode = selectedMode;
    document.getElementById("menu").style.display = "none";
    init();
    animate();
  }

  function init() {
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0x87ceeb);

    camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 10, 20);

    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const ambient = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambient);
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
    dirLight.position.set(10, 20, 0);
    scene.add(dirLight);

    createGround();

    document.addEventListener("keydown", (e) => { keys[e.code] = true; });
    document.addEventListener("keyup", (e) => { keys[e.code] = false; });

    document.body.addEventListener("click", () => {
      document.body.requestPointerLock();
    });

    document.addEventListener("mousemove", (event) => {
      if (document.pointerLockElement === document.body) {
        camera.rotation.y -= event.movementX * 0.002;
        camera.rotation.x -= event.movementY * 0.002;
        camera.rotation.x = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, camera.rotation.x));
      }
    });

    window.addEventListener("resize", onWindowResize, false);
  }

  function createGround() {
    const geometry = new THREE.BoxGeometry(BLOCK_SIZE, BLOCK_SIZE, BLOCK_SIZE);
    const materialGrass = new THREE.MeshLambertMaterial({ color: 0x00ff00 });
    const materialDirt = new THREE.MeshLambertMaterial({ color: 0x8b4513 });

    for (let x = -WORLD_SIZE / 2; x < WORLD_SIZE / 2; x++) {
      for (let z = -WORLD_SIZE / 2; z < WORLD_SIZE / 2; z++) {
        let y = Math.floor(Math.random() * 2);
        const block = new THREE.Mesh(geometry, y == 0 ? materialDirt : materialGrass);
        block.position.set(x * BLOCK_SIZE, -BLOCK_SIZE / 2 + y * BLOCK_SIZE, z * BLOCK_SIZE);
        scene.add(block);
      }
    }
  }

  function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }

  function animate() {
    requestAnimationFrame(animate);
    const delta = clock.getDelta();
    movePlayer(delta);
    renderer.render(scene, camera);
  }

  function movePlayer(delta) {
    const speed = mode === "creative" ? 20 : 10;

    player.direction.z = Number(keys["KeyW"]) - Number(keys["KeyS"]);
    player.direction.x = Number(keys["KeyD"]) - Number(keys["KeyA"]);
    player.direction.normalize();

    const moveX = player.direction.x * speed * delta;
    const moveZ = player.direction.z * speed * delta;

    const sinY = Math.sin(camera.rotation.y);
    const cosY = Math.cos(camera.rotation.y);

    camera.position.x += (moveX * cosY - moveZ * sinY);
    camera.position.z += (moveZ * cosY + moveX * sinY);

    if (mode === "creative" && keys["Space"]) camera.position.y += speed * delta;
    if (mode === "creative" && keys["ShiftLeft"]) camera.position.y -= speed * delta;
  }
  </script>
</body>
</html>
